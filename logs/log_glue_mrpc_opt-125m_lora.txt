Running experiment with data: glue_mrpc, model: facebook/opt-125m, LoRA type: lora
OPTForSequenceClassification(
  (model): OPTModel(
    (decoder): OPTDecoder(
      (embed_tokens): Embedding(50272, 768, padding_idx=1)
      (embed_positions): OPTLearnedPositionalEmbedding(2050, 768)
      (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x OPTDecoderLayer(
          (self_attn): OPTSdpaAttention(
            (k_proj): Linear(in_features=768, out_features=768, bias=True)
            (v_proj): Linear(in_features=768, out_features=768, bias=True)
            (q_proj): Linear(in_features=768, out_features=768, bias=True)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
          )
          (activation_fn): ReLU()
          (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=768, out_features=3072, bias=True)
          (fc2): Linear(in_features=3072, out_features=768, bias=True)
          (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
      )
    )
  )
  (score): Linear(in_features=768, out_features=2, bias=False)
)
===========================================================================
Layer (type:depth-idx)                             Param #
===========================================================================
OPTForSequenceClassification                       --
├─OPTModel: 1-1                                    --
│    └─OPTDecoder: 2-1                             --
│    │    └─Embedding: 3-1                         38,608,896
│    │    └─OPTLearnedPositionalEmbedding: 3-2     1,574,400
│    │    └─LayerNorm: 3-3                         1,536
│    │    └─ModuleList: 3-4                        85,054,464
├─Linear: 1-2                                      1,536
===========================================================================
Total params: 125,240,832
Trainable params: 125,240,832
Non-trainable params: 0
===========================================================================
===========================================================================
Layer (type:depth-idx)                             Param #
===========================================================================
OPTForSequenceClassification                       --
├─OPTModel: 1-1                                    --
│    └─OPTDecoder: 2-1                             --
│    │    └─Embedding: 3-1                         38,608,896
│    │    └─OPTLearnedPositionalEmbedding: 3-2     1,574,400
│    │    └─LayerNorm: 3-3                         1,536
│    │    └─ModuleList: 3-4                        85,054,464
├─Linear: 1-2                                      1,536
===========================================================================
Total params: 125,240,832
Trainable params: 125,240,832
Non-trainable params: 0
===========================================================================
OPTForSequenceClassification(
  (model): OPTModel(
    (decoder): OPTDecoder(
      (embed_tokens): Embedding(50272, 768, padding_idx=1)
      (embed_positions): OPTLearnedPositionalEmbedding(2050, 768)
      (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x OPTDecoderLayer(
          (self_attn): OPTSdpaAttention(
            (k_proj): Linear(in_features=768, out_features=768, bias=True)
            (v_proj): LoRALayer(
              (linear): Linear(in_features=768, out_features=768, bias=True)
            )
            (q_proj): LoRALayer(
              (linear): Linear(in_features=768, out_features=768, bias=True)
            )
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
          )
          (activation_fn): ReLU()
          (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=768, out_features=3072, bias=True)
          (fc2): Linear(in_features=3072, out_features=768, bias=True)
          (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
      )
    )
  )
  (score): Linear(in_features=768, out_features=2, bias=False)
)
===========================================================================
Layer (type:depth-idx)                             Param #
===========================================================================
OPTForSequenceClassification                       --
├─OPTModel: 1-1                                    --
│    └─OPTDecoder: 2-1                             --
│    │    └─Embedding: 3-1                         (38,608,896)
│    │    └─OPTLearnedPositionalEmbedding: 3-2     (1,574,400)
│    │    └─LayerNorm: 3-3                         (1,536)
│    │    └─ModuleList: 3-4                        85,349,376
├─Linear: 1-2                                      (1,536)
===========================================================================
Total params: 125,535,744
Trainable params: 294,912
Non-trainable params: 125,240,832
===========================================================================
===========================================================================
Layer (type:depth-idx)                             Param #
===========================================================================
OPTForSequenceClassification                       --
├─OPTModel: 1-1                                    --
│    └─OPTDecoder: 2-1                             --
│    │    └─Embedding: 3-1                         (38,608,896)
│    │    └─OPTLearnedPositionalEmbedding: 3-2     (1,574,400)
│    │    └─LayerNorm: 3-3                         (1,536)
│    │    └─ModuleList: 3-4                        85,349,376
├─Linear: 1-2                                      (1,536)
===========================================================================
Total params: 125,535,744
Trainable params: 294,912
Non-trainable params: 125,240,832
===========================================================================
Epoch 1/20
Batch 23/115 - Loss: 0.6460 - Accuracy: 0.6250
Batch 46/115 - Loss: 0.5457 - Accuracy: 0.7812
Batch 69/115 - Loss: 0.6891 - Accuracy: 0.5625
Batch 92/115 - Loss: 0.6275 - Accuracy: 0.6250
Batch 115/115 - Loss: 0.7140 - Accuracy: 0.6500
Epoch 1 - Train Loss: 0.6606 - Train Acc: 0.6508 - Val Loss: 0.6064 - Val Acc: 0.7019 - Time: 20.71s
Epoch 2/20
Batch 23/115 - Loss: 0.6162 - Accuracy: 0.6875
Batch 46/115 - Loss: 0.5157 - Accuracy: 0.7500
Batch 69/115 - Loss: 0.5954 - Accuracy: 0.6875
Batch 92/115 - Loss: 0.5961 - Accuracy: 0.6875
Batch 115/115 - Loss: 0.4876 - Accuracy: 0.8500
Epoch 2 - Train Loss: 0.6042 - Train Acc: 0.6854 - Val Loss: 0.5752 - Val Acc: 0.7091 - Time: 21.19s
Epoch 3/20
Batch 23/115 - Loss: 0.5914 - Accuracy: 0.7500
Batch 46/115 - Loss: 0.6431 - Accuracy: 0.5625
Batch 69/115 - Loss: 0.6762 - Accuracy: 0.6562
Batch 92/115 - Loss: 0.5198 - Accuracy: 0.7812
Batch 115/115 - Loss: 0.5492 - Accuracy: 0.7500
Epoch 3 - Train Loss: 0.5759 - Train Acc: 0.7022 - Val Loss: 0.5624 - Val Acc: 0.7236 - Time: 20.94s
Epoch 4/20
Batch 23/115 - Loss: 0.7342 - Accuracy: 0.5312
Batch 46/115 - Loss: 0.5177 - Accuracy: 0.7500
Batch 69/115 - Loss: 0.3502 - Accuracy: 0.8750
Batch 92/115 - Loss: 0.6422 - Accuracy: 0.6562
Batch 115/115 - Loss: 0.5154 - Accuracy: 0.7000
Epoch 4 - Train Loss: 0.5556 - Train Acc: 0.7175 - Val Loss: 0.5566 - Val Acc: 0.7260 - Time: 21.58s
Epoch 5/20
Batch 23/115 - Loss: 0.7031 - Accuracy: 0.6250
Batch 46/115 - Loss: 0.6292 - Accuracy: 0.6875
Batch 69/115 - Loss: 0.6153 - Accuracy: 0.6250
Batch 92/115 - Loss: 0.4899 - Accuracy: 0.7812
Batch 115/115 - Loss: 0.7225 - Accuracy: 0.6500
Epoch 5 - Train Loss: 0.5452 - Train Acc: 0.7350 - Val Loss: 0.5317 - Val Acc: 0.7260 - Time: 21.29s
Epoch 6/20
Batch 23/115 - Loss: 0.4859 - Accuracy: 0.6875
Batch 46/115 - Loss: 0.4612 - Accuracy: 0.8438
Batch 69/115 - Loss: 0.5036 - Accuracy: 0.7188
Batch 92/115 - Loss: 0.3885 - Accuracy: 0.8438
Batch 115/115 - Loss: 0.3367 - Accuracy: 0.9000
Epoch 6 - Train Loss: 0.5330 - Train Acc: 0.7388 - Val Loss: 0.5357 - Val Acc: 0.7388 - Time: 21.33s
Epoch 7/20
Batch 23/115 - Loss: 0.5829 - Accuracy: 0.7500
Batch 46/115 - Loss: 0.6761 - Accuracy: 0.7500
Batch 69/115 - Loss: 0.5507 - Accuracy: 0.6562
Batch 92/115 - Loss: 0.5647 - Accuracy: 0.7500
Batch 115/115 - Loss: 0.4697 - Accuracy: 0.7000
Epoch 7 - Train Loss: 0.5216 - Train Acc: 0.7482 - Val Loss: 0.5249 - Val Acc: 0.7500 - Time: 21.32s
Epoch 8/20
Batch 23/115 - Loss: 0.5248 - Accuracy: 0.7500
Batch 46/115 - Loss: 0.4474 - Accuracy: 0.8438
Batch 69/115 - Loss: 0.5824 - Accuracy: 0.6875
Batch 92/115 - Loss: 0.3872 - Accuracy: 0.8750
Batch 115/115 - Loss: 0.4623 - Accuracy: 0.8500
Epoch 8 - Train Loss: 0.5095 - Train Acc: 0.7547 - Val Loss: 0.5226 - Val Acc: 0.7476 - Time: 21.33s
Epoch 9/20
Batch 23/115 - Loss: 0.4182 - Accuracy: 0.8125
Batch 46/115 - Loss: 0.5562 - Accuracy: 0.7812
Batch 69/115 - Loss: 0.4550 - Accuracy: 0.8750
Batch 92/115 - Loss: 0.5038 - Accuracy: 0.7500
Batch 115/115 - Loss: 0.5318 - Accuracy: 0.8000
Epoch 9 - Train Loss: 0.5028 - Train Acc: 0.7632 - Val Loss: 0.5183 - Val Acc: 0.7612 - Time: 21.64s
Epoch 10/20
Batch 23/115 - Loss: 0.5731 - Accuracy: 0.7188
Batch 46/115 - Loss: 0.4420 - Accuracy: 0.7188
Batch 69/115 - Loss: 0.5156 - Accuracy: 0.7812
Batch 92/115 - Loss: 0.5579 - Accuracy: 0.7500
Batch 115/115 - Loss: 0.5516 - Accuracy: 0.7000
Epoch 10 - Train Loss: 0.4929 - Train Acc: 0.7729 - Val Loss: 0.5121 - Val Acc: 0.7636 - Time: 21.14s
Epoch 11/20
Batch 23/115 - Loss: 0.4904 - Accuracy: 0.7500
Batch 46/115 - Loss: 0.4452 - Accuracy: 0.8438
Batch 69/115 - Loss: 0.4935 - Accuracy: 0.7500
Batch 92/115 - Loss: 0.5358 - Accuracy: 0.7188
Batch 115/115 - Loss: 0.4117 - Accuracy: 0.9000
Epoch 11 - Train Loss: 0.4877 - Train Acc: 0.7701 - Val Loss: 0.4964 - Val Acc: 0.7628 - Time: 21.43s
Epoch 12/20
Batch 23/115 - Loss: 0.4580 - Accuracy: 0.8125
Batch 46/115 - Loss: 0.4916 - Accuracy: 0.8438
Batch 69/115 - Loss: 0.4811 - Accuracy: 0.7812
Batch 92/115 - Loss: 0.5775 - Accuracy: 0.6250
Batch 115/115 - Loss: 0.6407 - Accuracy: 0.7000
Epoch 12 - Train Loss: 0.4768 - Train Acc: 0.7765 - Val Loss: 0.5014 - Val Acc: 0.7612 - Time: 21.19s
Epoch 13/20
Batch 23/115 - Loss: 0.4242 - Accuracy: 0.8125
Batch 46/115 - Loss: 0.5320 - Accuracy: 0.7500
Batch 69/115 - Loss: 0.5600 - Accuracy: 0.6875
Batch 92/115 - Loss: 0.5637 - Accuracy: 0.7500
Batch 115/115 - Loss: 0.3769 - Accuracy: 0.8500
Epoch 13 - Train Loss: 0.4654 - Train Acc: 0.7884 - Val Loss: 0.4948 - Val Acc: 0.7668 - Time: 21.68s
Epoch 14/20
Batch 23/115 - Loss: 0.4908 - Accuracy: 0.7500
Batch 46/115 - Loss: 0.4237 - Accuracy: 0.8125
Batch 69/115 - Loss: 0.4696 - Accuracy: 0.7812
Batch 92/115 - Loss: 0.5265 - Accuracy: 0.7500
Batch 115/115 - Loss: 0.3946 - Accuracy: 0.8500
Epoch 14 - Train Loss: 0.4616 - Train Acc: 0.7884 - Val Loss: 0.4867 - Val Acc: 0.7788 - Time: 21.35s
Epoch 15/20
Batch 23/115 - Loss: 0.3956 - Accuracy: 0.8750
Batch 46/115 - Loss: 0.5047 - Accuracy: 0.7500
Batch 69/115 - Loss: 0.3867 - Accuracy: 0.8750
Batch 92/115 - Loss: 0.4513 - Accuracy: 0.7812
Batch 115/115 - Loss: 0.6362 - Accuracy: 0.6000
Epoch 15 - Train Loss: 0.4595 - Train Acc: 0.7924 - Val Loss: 0.4753 - Val Acc: 0.7780 - Time: 21.32s
Epoch 16/20
Batch 23/115 - Loss: 0.2817 - Accuracy: 0.8750
Batch 46/115 - Loss: 0.4942 - Accuracy: 0.7188
Batch 69/115 - Loss: 0.3542 - Accuracy: 0.9062
Batch 92/115 - Loss: 0.4015 - Accuracy: 0.8750
Batch 115/115 - Loss: 0.4587 - Accuracy: 0.8000
Epoch 16 - Train Loss: 0.4473 - Train Acc: 0.8037 - Val Loss: 0.4754 - Val Acc: 0.7885 - Time: 21.48s
Epoch 17/20
Batch 23/115 - Loss: 0.4825 - Accuracy: 0.7500
Batch 46/115 - Loss: 0.3934 - Accuracy: 0.7812
Batch 69/115 - Loss: 0.4229 - Accuracy: 0.7500
Batch 92/115 - Loss: 0.4940 - Accuracy: 0.7812
Batch 115/115 - Loss: 0.3419 - Accuracy: 0.8500
Epoch 17 - Train Loss: 0.4431 - Train Acc: 0.8006 - Val Loss: 0.4690 - Val Acc: 0.7812 - Time: 21.29s
Epoch 18/20
Batch 23/115 - Loss: 0.4764 - Accuracy: 0.7500
Batch 46/115 - Loss: 0.3835 - Accuracy: 0.7500
Batch 69/115 - Loss: 0.3536 - Accuracy: 0.8125
Batch 92/115 - Loss: 0.4510 - Accuracy: 0.7812
Batch 115/115 - Loss: 0.4011 - Accuracy: 0.8000
Epoch 18 - Train Loss: 0.4344 - Train Acc: 0.8037 - Val Loss: 0.4725 - Val Acc: 0.7957 - Time: 21.42s
Epoch 19/20
Batch 23/115 - Loss: 0.5218 - Accuracy: 0.6875
Batch 46/115 - Loss: 0.3947 - Accuracy: 0.8125
Batch 69/115 - Loss: 0.6042 - Accuracy: 0.6562
Batch 92/115 - Loss: 0.3690 - Accuracy: 0.8438
Batch 115/115 - Loss: 0.6705 - Accuracy: 0.6000
Epoch 19 - Train Loss: 0.4392 - Train Acc: 0.8039 - Val Loss: 0.4632 - Val Acc: 0.7804 - Time: 21.56s
Epoch 20/20
Batch 23/115 - Loss: 0.4598 - Accuracy: 0.6875
Batch 46/115 - Loss: 0.3621 - Accuracy: 0.8438
Batch 69/115 - Loss: 0.3972 - Accuracy: 0.8750
Batch 92/115 - Loss: 0.2827 - Accuracy: 0.8750
Batch 115/115 - Loss: 0.1949 - Accuracy: 1.0000
Epoch 20 - Train Loss: 0.4237 - Train Acc: 0.8087 - Val Loss: 0.4655 - Val Acc: 0.8013 - Time: 21.17s
Average Time per Epoch: 21.32s
Validation Loss: 0.4655, Validation Accuracy: 0.8013
