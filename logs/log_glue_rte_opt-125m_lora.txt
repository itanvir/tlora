Running experiment with data: glue_rte, model: facebook/opt-125m, LoRA type: lora
OPTForSequenceClassification(
  (model): OPTModel(
    (decoder): OPTDecoder(
      (embed_tokens): Embedding(50272, 768, padding_idx=1)
      (embed_positions): OPTLearnedPositionalEmbedding(2050, 768)
      (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x OPTDecoderLayer(
          (self_attn): OPTSdpaAttention(
            (k_proj): Linear(in_features=768, out_features=768, bias=True)
            (v_proj): Linear(in_features=768, out_features=768, bias=True)
            (q_proj): Linear(in_features=768, out_features=768, bias=True)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
          )
          (activation_fn): ReLU()
          (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=768, out_features=3072, bias=True)
          (fc2): Linear(in_features=3072, out_features=768, bias=True)
          (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
      )
    )
  )
  (score): Linear(in_features=768, out_features=2, bias=False)
)
===========================================================================
Layer (type:depth-idx)                             Param #
===========================================================================
OPTForSequenceClassification                       --
├─OPTModel: 1-1                                    --
│    └─OPTDecoder: 2-1                             --
│    │    └─Embedding: 3-1                         38,608,896
│    │    └─OPTLearnedPositionalEmbedding: 3-2     1,574,400
│    │    └─LayerNorm: 3-3                         1,536
│    │    └─ModuleList: 3-4                        85,054,464
├─Linear: 1-2                                      1,536
===========================================================================
Total params: 125,240,832
Trainable params: 125,240,832
Non-trainable params: 0
===========================================================================
===========================================================================
Layer (type:depth-idx)                             Param #
===========================================================================
OPTForSequenceClassification                       --
├─OPTModel: 1-1                                    --
│    └─OPTDecoder: 2-1                             --
│    │    └─Embedding: 3-1                         38,608,896
│    │    └─OPTLearnedPositionalEmbedding: 3-2     1,574,400
│    │    └─LayerNorm: 3-3                         1,536
│    │    └─ModuleList: 3-4                        85,054,464
├─Linear: 1-2                                      1,536
===========================================================================
Total params: 125,240,832
Trainable params: 125,240,832
Non-trainable params: 0
===========================================================================
OPTForSequenceClassification(
  (model): OPTModel(
    (decoder): OPTDecoder(
      (embed_tokens): Embedding(50272, 768, padding_idx=1)
      (embed_positions): OPTLearnedPositionalEmbedding(2050, 768)
      (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x OPTDecoderLayer(
          (self_attn): OPTSdpaAttention(
            (k_proj): Linear(in_features=768, out_features=768, bias=True)
            (v_proj): LoRALayer(
              (linear): Linear(in_features=768, out_features=768, bias=True)
            )
            (q_proj): LoRALayer(
              (linear): Linear(in_features=768, out_features=768, bias=True)
            )
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
          )
          (activation_fn): ReLU()
          (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=768, out_features=3072, bias=True)
          (fc2): Linear(in_features=3072, out_features=768, bias=True)
          (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
      )
    )
  )
  (score): Linear(in_features=768, out_features=2, bias=False)
)
===========================================================================
Layer (type:depth-idx)                             Param #
===========================================================================
OPTForSequenceClassification                       --
├─OPTModel: 1-1                                    --
│    └─OPTDecoder: 2-1                             --
│    │    └─Embedding: 3-1                         (38,608,896)
│    │    └─OPTLearnedPositionalEmbedding: 3-2     (1,574,400)
│    │    └─LayerNorm: 3-3                         (1,536)
│    │    └─ModuleList: 3-4                        85,349,376
├─Linear: 1-2                                      (1,536)
===========================================================================
Total params: 125,535,744
Trainable params: 294,912
Non-trainable params: 125,240,832
===========================================================================
===========================================================================
Layer (type:depth-idx)                             Param #
===========================================================================
OPTForSequenceClassification                       --
├─OPTModel: 1-1                                    --
│    └─OPTDecoder: 2-1                             --
│    │    └─Embedding: 3-1                         (38,608,896)
│    │    └─OPTLearnedPositionalEmbedding: 3-2     (1,574,400)
│    │    └─LayerNorm: 3-3                         (1,536)
│    │    └─ModuleList: 3-4                        85,349,376
├─Linear: 1-2                                      (1,536)
===========================================================================
Total params: 125,535,744
Trainable params: 294,912
Non-trainable params: 125,240,832
===========================================================================
Epoch 1/20
Batch 15/78 - Loss: 0.7585 - Accuracy: 0.4375
Batch 30/78 - Loss: 0.7387 - Accuracy: 0.6250
Batch 45/78 - Loss: 0.7121 - Accuracy: 0.5625
Batch 60/78 - Loss: 0.7576 - Accuracy: 0.4688
Batch 75/78 - Loss: 0.7010 - Accuracy: 0.5938
Epoch 1 - Train Loss: 0.7297 - Train Acc: 0.5023 - Val Loss: 0.7008 - Val Acc: 0.5372 - Time: 38.20s
Epoch 2/20
Batch 15/78 - Loss: 0.7459 - Accuracy: 0.5312
Batch 30/78 - Loss: 0.7162 - Accuracy: 0.4688
Batch 45/78 - Loss: 0.7872 - Accuracy: 0.4375
Batch 60/78 - Loss: 0.6743 - Accuracy: 0.5938
Batch 75/78 - Loss: 0.7285 - Accuracy: 0.4375
Epoch 2 - Train Loss: 0.7117 - Train Acc: 0.5282 - Val Loss: 0.6941 - Val Acc: 0.5427 - Time: 37.39s
Epoch 3/20
Batch 15/78 - Loss: 0.7295 - Accuracy: 0.4688
Batch 30/78 - Loss: 0.6527 - Accuracy: 0.6250
Batch 45/78 - Loss: 0.6675 - Accuracy: 0.5938
Batch 60/78 - Loss: 0.6496 - Accuracy: 0.6562
Batch 75/78 - Loss: 0.6844 - Accuracy: 0.5625
Epoch 3 - Train Loss: 0.6996 - Train Acc: 0.5399 - Val Loss: 0.6890 - Val Acc: 0.5584 - Time: 37.28s
Epoch 4/20
Batch 15/78 - Loss: 0.7142 - Accuracy: 0.4688
Batch 30/78 - Loss: 0.6554 - Accuracy: 0.5938
Batch 45/78 - Loss: 0.7373 - Accuracy: 0.5000
Batch 60/78 - Loss: 0.7058 - Accuracy: 0.5625
Batch 75/78 - Loss: 0.7132 - Accuracy: 0.4062
Epoch 4 - Train Loss: 0.6949 - Train Acc: 0.5489 - Val Loss: 0.6798 - Val Acc: 0.5896 - Time: 37.48s
Epoch 5/20
Batch 15/78 - Loss: 0.6553 - Accuracy: 0.5938
Batch 30/78 - Loss: 0.6797 - Accuracy: 0.5625
Batch 45/78 - Loss: 0.6158 - Accuracy: 0.6250
Batch 60/78 - Loss: 0.6382 - Accuracy: 0.6250
Batch 75/78 - Loss: 0.6437 - Accuracy: 0.5938
Epoch 5 - Train Loss: 0.6867 - Train Acc: 0.5523 - Val Loss: 0.6772 - Val Acc: 0.6000 - Time: 38.56s
Epoch 6/20
Batch 15/78 - Loss: 0.6033 - Accuracy: 0.7188
Batch 30/78 - Loss: 0.6962 - Accuracy: 0.5938
Batch 45/78 - Loss: 0.6609 - Accuracy: 0.5938
Batch 60/78 - Loss: 0.7049 - Accuracy: 0.4375
Batch 75/78 - Loss: 0.7183 - Accuracy: 0.5000
Epoch 6 - Train Loss: 0.6773 - Train Acc: 0.5696 - Val Loss: 0.6741 - Val Acc: 0.6088 - Time: 39.24s
Epoch 7/20
Batch 15/78 - Loss: 0.6999 - Accuracy: 0.5625
Batch 30/78 - Loss: 0.6884 - Accuracy: 0.5000
Batch 45/78 - Loss: 0.6460 - Accuracy: 0.7188
Batch 60/78 - Loss: 0.6536 - Accuracy: 0.5625
Batch 75/78 - Loss: 0.6814 - Accuracy: 0.5938
Epoch 7 - Train Loss: 0.6706 - Train Acc: 0.5809 - Val Loss: 0.6722 - Val Acc: 0.5896 - Time: 36.14s
Epoch 8/20
Batch 15/78 - Loss: 0.5885 - Accuracy: 0.7812
Batch 30/78 - Loss: 0.6768 - Accuracy: 0.5938
Batch 45/78 - Loss: 0.7097 - Accuracy: 0.5000
Batch 60/78 - Loss: 0.6236 - Accuracy: 0.5938
Batch 75/78 - Loss: 0.6808 - Accuracy: 0.5312
Epoch 8 - Train Loss: 0.6622 - Train Acc: 0.5968 - Val Loss: 0.6733 - Val Acc: 0.5498 - Time: 37.60s
Epoch 9/20
Batch 15/78 - Loss: 0.6471 - Accuracy: 0.5625
Batch 30/78 - Loss: 0.6795 - Accuracy: 0.5938
Batch 45/78 - Loss: 0.6901 - Accuracy: 0.4688
Batch 60/78 - Loss: 0.6466 - Accuracy: 0.5938
Batch 75/78 - Loss: 0.6320 - Accuracy: 0.6250
Epoch 9 - Train Loss: 0.6520 - Train Acc: 0.6182 - Val Loss: 0.6640 - Val Acc: 0.6020 - Time: 37.52s
Epoch 10/20
Batch 15/78 - Loss: 0.6139 - Accuracy: 0.7188
Batch 30/78 - Loss: 0.6738 - Accuracy: 0.5938
Batch 45/78 - Loss: 0.6326 - Accuracy: 0.6875
Batch 60/78 - Loss: 0.6294 - Accuracy: 0.6250
Batch 75/78 - Loss: 0.6248 - Accuracy: 0.6250
Epoch 10 - Train Loss: 0.6383 - Train Acc: 0.6270 - Val Loss: 0.6577 - Val Acc: 0.5759 - Time: 38.31s
Epoch 11/20
Batch 15/78 - Loss: 0.5905 - Accuracy: 0.7500
Batch 30/78 - Loss: 0.6358 - Accuracy: 0.6562
Batch 45/78 - Loss: 0.6179 - Accuracy: 0.6562
Batch 60/78 - Loss: 0.7089 - Accuracy: 0.5312
Batch 75/78 - Loss: 0.7188 - Accuracy: 0.5625
Epoch 11 - Train Loss: 0.6222 - Train Acc: 0.6541 - Val Loss: 0.6422 - Val Acc: 0.6212 - Time: 36.09s
Epoch 12/20
Batch 15/78 - Loss: 0.6854 - Accuracy: 0.5312
Batch 30/78 - Loss: 0.6237 - Accuracy: 0.6250
Batch 45/78 - Loss: 0.6466 - Accuracy: 0.6875
Batch 60/78 - Loss: 0.5517 - Accuracy: 0.6875
Batch 75/78 - Loss: 0.5252 - Accuracy: 0.7188
Epoch 12 - Train Loss: 0.6056 - Train Acc: 0.6682 - Val Loss: 0.6351 - Val Acc: 0.6177 - Time: 36.63s
Epoch 13/20
Batch 15/78 - Loss: 0.6109 - Accuracy: 0.5625
Batch 30/78 - Loss: 0.5897 - Accuracy: 0.6875
Batch 45/78 - Loss: 0.7128 - Accuracy: 0.5000
Batch 60/78 - Loss: 0.6296 - Accuracy: 0.6562
Batch 75/78 - Loss: 0.5079 - Accuracy: 0.7812
Epoch 13 - Train Loss: 0.5870 - Train Acc: 0.6883 - Val Loss: 0.6377 - Val Acc: 0.6316 - Time: 36.99s
Epoch 14/20
Batch 15/78 - Loss: 0.7257 - Accuracy: 0.5625
Batch 30/78 - Loss: 0.4820 - Accuracy: 0.8125
Batch 45/78 - Loss: 0.4068 - Accuracy: 0.8750
Batch 60/78 - Loss: 0.5380 - Accuracy: 0.7188
Batch 75/78 - Loss: 0.5407 - Accuracy: 0.6562
Epoch 14 - Train Loss: 0.5716 - Train Acc: 0.6977 - Val Loss: 0.6304 - Val Acc: 0.6300 - Time: 36.76s
Epoch 15/20
Batch 15/78 - Loss: 0.4641 - Accuracy: 0.8438
Batch 30/78 - Loss: 0.6781 - Accuracy: 0.6562
Batch 45/78 - Loss: 0.6056 - Accuracy: 0.7188
Batch 60/78 - Loss: 0.5113 - Accuracy: 0.7188
Batch 75/78 - Loss: 0.7221 - Accuracy: 0.5000
Epoch 15 - Train Loss: 0.5652 - Train Acc: 0.7024 - Val Loss: 0.6268 - Val Acc: 0.6369 - Time: 36.38s
Epoch 16/20
Batch 15/78 - Loss: 0.5897 - Accuracy: 0.6250
Batch 30/78 - Loss: 0.5112 - Accuracy: 0.7500
Batch 45/78 - Loss: 0.4566 - Accuracy: 0.8438
Batch 60/78 - Loss: 0.5080 - Accuracy: 0.7500
Batch 75/78 - Loss: 0.4421 - Accuracy: 0.7500
Epoch 16 - Train Loss: 0.5474 - Train Acc: 0.7199 - Val Loss: 0.6254 - Val Acc: 0.6422 - Time: 40.06s
Epoch 17/20
Batch 15/78 - Loss: 0.4669 - Accuracy: 0.8438
Batch 30/78 - Loss: 0.4474 - Accuracy: 0.8125
Batch 45/78 - Loss: 0.7022 - Accuracy: 0.6250
Batch 60/78 - Loss: 0.5506 - Accuracy: 0.6875
Batch 75/78 - Loss: 0.4729 - Accuracy: 0.8438
Epoch 17 - Train Loss: 0.5419 - Train Acc: 0.7243 - Val Loss: 0.6318 - Val Acc: 0.6455 - Time: 37.27s
Epoch 18/20
Batch 15/78 - Loss: 0.4546 - Accuracy: 0.7500
Batch 30/78 - Loss: 0.5389 - Accuracy: 0.7500
Batch 45/78 - Loss: 0.5713 - Accuracy: 0.6250
Batch 60/78 - Loss: 0.7259 - Accuracy: 0.5625
Batch 75/78 - Loss: 0.5087 - Accuracy: 0.6875
Epoch 18 - Train Loss: 0.5298 - Train Acc: 0.7250 - Val Loss: 0.6205 - Val Acc: 0.6543 - Time: 38.76s
Epoch 19/20
Batch 15/78 - Loss: 0.5070 - Accuracy: 0.7500
Batch 30/78 - Loss: 0.4357 - Accuracy: 0.7188
Batch 45/78 - Loss: 0.5426 - Accuracy: 0.7812
Batch 60/78 - Loss: 0.5511 - Accuracy: 0.7500
Batch 75/78 - Loss: 0.5376 - Accuracy: 0.7500
Epoch 19 - Train Loss: 0.5112 - Train Acc: 0.7474 - Val Loss: 0.6243 - Val Acc: 0.6524 - Time: 37.43s
Epoch 20/20
Batch 15/78 - Loss: 0.6559 - Accuracy: 0.6875
Batch 30/78 - Loss: 0.6164 - Accuracy: 0.6562
Batch 45/78 - Loss: 0.5513 - Accuracy: 0.7188
Batch 60/78 - Loss: 0.5184 - Accuracy: 0.7812
Batch 75/78 - Loss: 0.5576 - Accuracy: 0.6875
Epoch 20 - Train Loss: 0.5167 - Train Acc: 0.7417 - Val Loss: 0.6189 - Val Acc: 0.6543 - Time: 37.39s
Average Time per Epoch: 37.57s
Validation Loss: 0.6189, Validation Accuracy: 0.6543
