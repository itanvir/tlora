Running experiment with data: glue_mrpc, model: facebook/opt-125m, LoRA type: tlora
OPTForSequenceClassification(
  (model): OPTModel(
    (decoder): OPTDecoder(
      (embed_tokens): Embedding(50272, 768, padding_idx=1)
      (embed_positions): OPTLearnedPositionalEmbedding(2050, 768)
      (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x OPTDecoderLayer(
          (self_attn): OPTSdpaAttention(
            (k_proj): Linear(in_features=768, out_features=768, bias=True)
            (v_proj): Linear(in_features=768, out_features=768, bias=True)
            (q_proj): Linear(in_features=768, out_features=768, bias=True)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
          )
          (activation_fn): ReLU()
          (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=768, out_features=3072, bias=True)
          (fc2): Linear(in_features=3072, out_features=768, bias=True)
          (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
      )
    )
  )
  (score): Linear(in_features=768, out_features=2, bias=False)
)
===========================================================================
Layer (type:depth-idx)                             Param #
===========================================================================
OPTForSequenceClassification                       --
├─OPTModel: 1-1                                    --
│    └─OPTDecoder: 2-1                             --
│    │    └─Embedding: 3-1                         38,608,896
│    │    └─OPTLearnedPositionalEmbedding: 3-2     1,574,400
│    │    └─LayerNorm: 3-3                         1,536
│    │    └─ModuleList: 3-4                        85,054,464
├─Linear: 1-2                                      1,536
===========================================================================
Total params: 125,240,832
Trainable params: 125,240,832
Non-trainable params: 0
===========================================================================
===========================================================================
Layer (type:depth-idx)                             Param #
===========================================================================
OPTForSequenceClassification                       --
├─OPTModel: 1-1                                    --
│    └─OPTDecoder: 2-1                             --
│    │    └─Embedding: 3-1                         38,608,896
│    │    └─OPTLearnedPositionalEmbedding: 3-2     1,574,400
│    │    └─LayerNorm: 3-3                         1,536
│    │    └─ModuleList: 3-4                        85,054,464
├─Linear: 1-2                                      1,536
===========================================================================
Total params: 125,240,832
Trainable params: 125,240,832
Non-trainable params: 0
===========================================================================
OPTForSequenceClassification(
  (model): OPTModel(
    (decoder): OPTDecoder(
      (embed_tokens): Embedding(50272, 768, padding_idx=1)
      (embed_positions): OPTLearnedPositionalEmbedding(2050, 768)
      (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x OPTDecoderLayer(
          (self_attn): OPTSdpaAttention(
            (k_proj): Linear(in_features=768, out_features=768, bias=True)
            (v_proj): TLoRALayer(
              (linear): Linear(in_features=768, out_features=768, bias=True)
            )
            (q_proj): TLoRALayer(
              (linear): Linear(in_features=768, out_features=768, bias=True)
            )
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
          )
          (activation_fn): ReLU()
          (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=768, out_features=3072, bias=True)
          (fc2): Linear(in_features=3072, out_features=768, bias=True)
          (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
      )
    )
  )
  (score): Linear(in_features=768, out_features=2, bias=False)
)
===========================================================================
Layer (type:depth-idx)                             Param #
===========================================================================
OPTForSequenceClassification                       --
├─OPTModel: 1-1                                    --
│    └─OPTDecoder: 2-1                             --
│    │    └─Embedding: 3-1                         (38,608,896)
│    │    └─OPTLearnedPositionalEmbedding: 3-2     (1,574,400)
│    │    └─LayerNorm: 3-3                         (1,536)
│    │    └─ModuleList: 3-4                        85,313,688
├─Linear: 1-2                                      (1,536)
===========================================================================
Total params: 125,500,056
Trainable params: 259,224
Non-trainable params: 125,240,832
===========================================================================
===========================================================================
Layer (type:depth-idx)                             Param #
===========================================================================
OPTForSequenceClassification                       --
├─OPTModel: 1-1                                    --
│    └─OPTDecoder: 2-1                             --
│    │    └─Embedding: 3-1                         (38,608,896)
│    │    └─OPTLearnedPositionalEmbedding: 3-2     (1,574,400)
│    │    └─LayerNorm: 3-3                         (1,536)
│    │    └─ModuleList: 3-4                        85,313,688
├─Linear: 1-2                                      (1,536)
===========================================================================
Total params: 125,500,056
Trainable params: 259,224
Non-trainable params: 125,240,832
===========================================================================
Epoch 1/20
Batch 23/115 - Loss: 0.7180 - Accuracy: 0.5000
Batch 46/115 - Loss: 0.6831 - Accuracy: 0.6562
Batch 69/115 - Loss: 0.5281 - Accuracy: 0.7500
Batch 92/115 - Loss: 0.5665 - Accuracy: 0.7812
Batch 115/115 - Loss: 0.4748 - Accuracy: 0.7000
Epoch 1 - Train Loss: 0.6161 - Train Acc: 0.6835 - Val Loss: 0.5463 - Val Acc: 0.7252 - Time: 27.21s
Epoch 2/20
Batch 23/115 - Loss: 0.5432 - Accuracy: 0.6250
Batch 46/115 - Loss: 0.6062 - Accuracy: 0.6562
Batch 69/115 - Loss: 0.5956 - Accuracy: 0.6562
Batch 92/115 - Loss: 0.6282 - Accuracy: 0.7500
Batch 115/115 - Loss: 0.4089 - Accuracy: 0.8500
Epoch 2 - Train Loss: 0.5471 - Train Acc: 0.7289 - Val Loss: 0.5046 - Val Acc: 0.7492 - Time: 22.37s
Epoch 3/20
Batch 23/115 - Loss: 0.6136 - Accuracy: 0.6562
Batch 46/115 - Loss: 0.6243 - Accuracy: 0.6562
Batch 69/115 - Loss: 0.4214 - Accuracy: 0.8750
Batch 92/115 - Loss: 0.5833 - Accuracy: 0.6562
Batch 115/115 - Loss: 0.5211 - Accuracy: 0.7000
Epoch 3 - Train Loss: 0.5107 - Train Acc: 0.7485 - Val Loss: 0.5870 - Val Acc: 0.7244 - Time: 22.68s
Epoch 4/20
Batch 23/115 - Loss: 0.4724 - Accuracy: 0.8125
Batch 46/115 - Loss: 0.4834 - Accuracy: 0.7500
Batch 69/115 - Loss: 0.4152 - Accuracy: 0.8750
Batch 92/115 - Loss: 0.3774 - Accuracy: 0.8125
Batch 115/115 - Loss: 0.5965 - Accuracy: 0.7000
Epoch 4 - Train Loss: 0.4871 - Train Acc: 0.7716 - Val Loss: 0.4621 - Val Acc: 0.7612 - Time: 22.95s
Epoch 5/20
Batch 23/115 - Loss: 0.3811 - Accuracy: 0.8438
Batch 46/115 - Loss: 0.3879 - Accuracy: 0.8438
Batch 69/115 - Loss: 0.4961 - Accuracy: 0.7812
Batch 92/115 - Loss: 0.3821 - Accuracy: 0.8125
Batch 115/115 - Loss: 0.3837 - Accuracy: 0.8500
Epoch 5 - Train Loss: 0.4535 - Train Acc: 0.7922 - Val Loss: 0.4587 - Val Acc: 0.7949 - Time: 23.06s
Epoch 6/20
Batch 23/115 - Loss: 0.3754 - Accuracy: 0.8438
Batch 46/115 - Loss: 0.3987 - Accuracy: 0.8438
Batch 69/115 - Loss: 0.4348 - Accuracy: 0.7188
Batch 92/115 - Loss: 0.3794 - Accuracy: 0.9062
Batch 115/115 - Loss: 0.2705 - Accuracy: 0.8500
Epoch 6 - Train Loss: 0.4322 - Train Acc: 0.8052 - Val Loss: 0.4565 - Val Acc: 0.7829 - Time: 23.32s
Epoch 7/20
Batch 23/115 - Loss: 0.3295 - Accuracy: 0.8750
Batch 46/115 - Loss: 0.4555 - Accuracy: 0.8438
Batch 69/115 - Loss: 0.5161 - Accuracy: 0.7812
Batch 92/115 - Loss: 0.3101 - Accuracy: 0.8750
Batch 115/115 - Loss: 0.4466 - Accuracy: 0.7000
Epoch 7 - Train Loss: 0.4194 - Train Acc: 0.8148 - Val Loss: 0.4465 - Val Acc: 0.8093 - Time: 23.45s
Epoch 8/20
Batch 23/115 - Loss: 0.3646 - Accuracy: 0.8438
Batch 46/115 - Loss: 0.4043 - Accuracy: 0.9062
Batch 69/115 - Loss: 0.5033 - Accuracy: 0.7812
Batch 92/115 - Loss: 0.4844 - Accuracy: 0.7812
Batch 115/115 - Loss: 0.3110 - Accuracy: 0.9000
Epoch 8 - Train Loss: 0.3918 - Train Acc: 0.8301 - Val Loss: 0.4551 - Val Acc: 0.7909 - Time: 22.85s
Epoch 9/20
Batch 23/115 - Loss: 0.5532 - Accuracy: 0.7500
Batch 46/115 - Loss: 0.4279 - Accuracy: 0.7812
Batch 69/115 - Loss: 0.2715 - Accuracy: 0.9375
Batch 92/115 - Loss: 0.3540 - Accuracy: 0.8125
Batch 115/115 - Loss: 0.2270 - Accuracy: 0.9000
Epoch 9 - Train Loss: 0.3682 - Train Acc: 0.8423 - Val Loss: 0.4956 - Val Acc: 0.7877 - Time: 23.68s
Epoch 10/20
Batch 23/115 - Loss: 0.2578 - Accuracy: 0.9062
Batch 46/115 - Loss: 0.2939 - Accuracy: 0.9062
Batch 69/115 - Loss: 0.4691 - Accuracy: 0.8438
Batch 92/115 - Loss: 0.3744 - Accuracy: 0.8438
Batch 115/115 - Loss: 0.4241 - Accuracy: 0.8500
Epoch 10 - Train Loss: 0.3612 - Train Acc: 0.8452 - Val Loss: 0.4948 - Val Acc: 0.7973 - Time: 23.12s
Epoch 11/20
Batch 23/115 - Loss: 0.2621 - Accuracy: 0.9062
Batch 46/115 - Loss: 0.3534 - Accuracy: 0.8750
Batch 69/115 - Loss: 0.3813 - Accuracy: 0.8750
Batch 92/115 - Loss: 0.2428 - Accuracy: 0.9375
Batch 115/115 - Loss: 0.3187 - Accuracy: 0.8500
Epoch 11 - Train Loss: 0.3315 - Train Acc: 0.8585 - Val Loss: 0.4793 - Val Acc: 0.8141 - Time: 22.77s
Epoch 12/20
Batch 23/115 - Loss: 0.2757 - Accuracy: 0.9062
Batch 46/115 - Loss: 0.2378 - Accuracy: 0.8750
Batch 69/115 - Loss: 0.3467 - Accuracy: 0.8125
Batch 92/115 - Loss: 0.3536 - Accuracy: 0.8438
Batch 115/115 - Loss: 0.2907 - Accuracy: 0.8500
Epoch 12 - Train Loss: 0.3148 - Train Acc: 0.8699 - Val Loss: 0.4979 - Val Acc: 0.8109 - Time: 23.17s
Epoch 13/20
Batch 23/115 - Loss: 0.3404 - Accuracy: 0.8438
Batch 46/115 - Loss: 0.3129 - Accuracy: 0.9062
Batch 69/115 - Loss: 0.2130 - Accuracy: 0.9688
Batch 92/115 - Loss: 0.3956 - Accuracy: 0.7812
Batch 115/115 - Loss: 0.3318 - Accuracy: 0.9000
Epoch 13 - Train Loss: 0.2943 - Train Acc: 0.8812 - Val Loss: 0.4668 - Val Acc: 0.8053 - Time: 22.87s
Epoch 14/20
Batch 23/115 - Loss: 0.1647 - Accuracy: 0.9375
Batch 46/115 - Loss: 0.2768 - Accuracy: 0.9062
Batch 69/115 - Loss: 0.2634 - Accuracy: 0.9062
Batch 92/115 - Loss: 0.3848 - Accuracy: 0.7812
Batch 115/115 - Loss: 0.2363 - Accuracy: 1.0000
Epoch 14 - Train Loss: 0.2852 - Train Acc: 0.8780 - Val Loss: 0.4570 - Val Acc: 0.8013 - Time: 22.43s
Epoch 15/20
Batch 23/115 - Loss: 0.4662 - Accuracy: 0.8125
Batch 46/115 - Loss: 0.1431 - Accuracy: 0.9062
Batch 69/115 - Loss: 0.2576 - Accuracy: 0.9062
Batch 92/115 - Loss: 0.3802 - Accuracy: 0.8125
Batch 115/115 - Loss: 0.2687 - Accuracy: 0.8500
Epoch 15 - Train Loss: 0.2697 - Train Acc: 0.8892 - Val Loss: 0.5040 - Val Acc: 0.8109 - Time: 22.96s
Epoch 16/20
Batch 23/115 - Loss: 0.2390 - Accuracy: 0.9062
Batch 46/115 - Loss: 0.2072 - Accuracy: 0.9062
Batch 69/115 - Loss: 0.1375 - Accuracy: 0.9375
Batch 92/115 - Loss: 0.2190 - Accuracy: 0.9062
Batch 115/115 - Loss: 0.1684 - Accuracy: 1.0000
Epoch 16 - Train Loss: 0.2537 - Train Acc: 0.8989 - Val Loss: 0.5476 - Val Acc: 0.7981 - Time: 23.92s
Epoch 17/20
Batch 23/115 - Loss: 0.3419 - Accuracy: 0.8125
Batch 46/115 - Loss: 0.3856 - Accuracy: 0.8438
Batch 69/115 - Loss: 0.1565 - Accuracy: 0.9688
Batch 92/115 - Loss: 0.2188 - Accuracy: 0.9375
Batch 115/115 - Loss: 0.2146 - Accuracy: 0.8500
Epoch 17 - Train Loss: 0.2344 - Train Acc: 0.9098 - Val Loss: 0.6000 - Val Acc: 0.8013 - Time: 23.05s
Epoch 18/20
Batch 23/115 - Loss: 0.1863 - Accuracy: 0.9062
Batch 46/115 - Loss: 0.1186 - Accuracy: 1.0000
Batch 69/115 - Loss: 0.2436 - Accuracy: 0.9062
Batch 92/115 - Loss: 0.2345 - Accuracy: 0.8438
Batch 115/115 - Loss: 0.1346 - Accuracy: 0.9000
Epoch 18 - Train Loss: 0.2329 - Train Acc: 0.9078 - Val Loss: 0.5030 - Val Acc: 0.7917 - Time: 22.57s
Epoch 19/20
Batch 23/115 - Loss: 0.4340 - Accuracy: 0.8750
Batch 46/115 - Loss: 0.2624 - Accuracy: 0.9062
Batch 69/115 - Loss: 0.1387 - Accuracy: 0.9375
Batch 92/115 - Loss: 0.1796 - Accuracy: 0.9062
Batch 115/115 - Loss: 0.0675 - Accuracy: 1.0000
Epoch 19 - Train Loss: 0.2103 - Train Acc: 0.9185 - Val Loss: 0.5591 - Val Acc: 0.8093 - Time: 22.82s
Epoch 20/20
Batch 23/115 - Loss: 0.2083 - Accuracy: 0.9375
Batch 46/115 - Loss: 0.1744 - Accuracy: 0.9375
Batch 69/115 - Loss: 0.1108 - Accuracy: 0.9688
Batch 92/115 - Loss: 0.2477 - Accuracy: 0.9062
Batch 115/115 - Loss: 0.3242 - Accuracy: 0.7500
Epoch 20 - Train Loss: 0.2105 - Train Acc: 0.9179 - Val Loss: 0.5521 - Val Acc: 0.8061 - Time: 22.97s
Average Time per Epoch: 23.21s
Validation Loss: 0.5521, Validation Accuracy: 0.8061
